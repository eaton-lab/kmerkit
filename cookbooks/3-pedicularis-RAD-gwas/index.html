
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>GWAS RAD-seq - kmerkit (UNDER ACTIVE DEVELOPMENT)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#workflow-diagram" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="kmerkit (UNDER ACTIVE DEVELOPMENT)" class="md-header__button md-logo" aria-label="kmerkit (UNDER ACTIVE DEVELOPMENT)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 13C0 6.373 5.373 1 12 1s12 5.373 12 12v8.657a.75.75 0 0 1-1.5 0V13c0-5.799-4.701-10.5-10.5-10.5S1.5 7.201 1.5 13v8.657a.75.75 0 0 1-1.5 0V13z"/><path d="M8 19.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75z"/><path fill-rule="evenodd" d="M5.25 9.5a1.75 1.75 0 0 0-1.75 1.75v3.5c0 .966.784 1.75 1.75 1.75h13.5a1.75 1.75 0 0 0 1.75-1.75v-3.5a1.75 1.75 0 0 0-1.75-1.75H5.25zm.22 1.47a.75.75 0 0 1 1.06 0L9 13.44l2.47-2.47a.75.75 0 0 1 1.06 0L15 13.44l2.47-2.47a.75.75 0 1 1 1.06 1.06l-3 3a.75.75 0 0 1-1.06 0L12 12.56l-2.47 2.47a.75.75 0 0 1-1.06 0l-3-3a.75.75 0 0 1 0-1.06z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            kmerkit (UNDER ACTIVE DEVELOPMENT)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GWAS RAD-seq
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/eaton-lab/kmerkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../ethos/" class="md-tabs__link">
      About/Ethos
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../installation/" class="md-tabs__link">
      Installation
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../quick-start/" class="md-tabs__link">
        Tutorial - User Guide
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../1-amaranthus-dioecy/" class="md-tabs__link md-tabs__link--active">
        Cookbooks
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="kmerkit (UNDER ACTIVE DEVELOPMENT)" class="md-nav__button md-logo" aria-label="kmerkit (UNDER ACTIVE DEVELOPMENT)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 13C0 6.373 5.373 1 12 1s12 5.373 12 12v8.657a.75.75 0 0 1-1.5 0V13c0-5.799-4.701-10.5-10.5-10.5S1.5 7.201 1.5 13v8.657a.75.75 0 0 1-1.5 0V13z"/><path d="M8 19.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75z"/><path fill-rule="evenodd" d="M5.25 9.5a1.75 1.75 0 0 0-1.75 1.75v3.5c0 .966.784 1.75 1.75 1.75h13.5a1.75 1.75 0 0 0 1.75-1.75v-3.5a1.75 1.75 0 0 0-1.75-1.75H5.25zm.22 1.47a.75.75 0 0 1 1.06 0L9 13.44l2.47-2.47a.75.75 0 0 1 1.06 0L15 13.44l2.47-2.47a.75.75 0 1 1 1.06 1.06l-3 3a.75.75 0 0 1-1.06 0L12 12.56l-2.47 2.47a.75.75 0 0 1-1.06 0l-3-3a.75.75 0 0 1 0-1.06z"/></svg>

    </a>
    kmerkit (UNDER ACTIVE DEVELOPMENT)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eaton-lab/kmerkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../ethos/" class="md-nav__link">
        About/Ethos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tutorial - User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial - User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorial - User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/" class="md-nav__link">
        Quick-start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kinit.md" class="md-nav__link">
        kinit - start a project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kfilter/" class="md-nav__link">
        ktrim - read trim/filter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kcount/" class="md-nav__link">
        kcount - counting kmers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kfilter/" class="md-nav__link">
        kfilter - select target kmers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kfilter/" class="md-nav__link">
        kextract - select target reads
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kmatrix.md" class="md-nav__link">
        kmatrix - export genotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kmatrix.md" class="md-nav__link">
        kgwas - GWAS inference
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Cookbooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cookbooks" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Cookbooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1-amaranthus-dioecy/" class="md-nav__link">
        GWAS WGS sex-determination (Amaranth)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2-arabidopsis-gwas/" class="md-nav__link">
        GWAS WGS many traits (Arabidopsis)
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          GWAS RAD-seq
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        GWAS RAD-seq
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#workflow-diagram" class="md-nav__link">
    Workflow diagram
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#study-description" class="md-nav__link">
    Study description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetch-fastq-data" class="md-nav__link">
    Fetch fastq data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kmerkit-analysis" class="md-nav__link">
    Kmerkit analysis
  </a>
  
    <nav class="md-nav" aria-label="Kmerkit analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialize-a-new-project" class="md-nav__link">
    Initialize a new project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-trimming-optional" class="md-nav__link">
    Read trimming (optional)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count-kmers" class="md-nav__link">
    Count kmers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-kmers" class="md-nav__link">
    Filter kmers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-gwas" class="md-nav__link">
    Perform GWAS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reproducibility" class="md-nav__link">
    Reproducibility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#todo-post-pipeline-analysisvisualization-api" class="md-nav__link">
    TODO: Post-pipeline analysis/visualization API
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#workflow-diagram" class="md-nav__link">
    Workflow diagram
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#study-description" class="md-nav__link">
    Study description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetch-fastq-data" class="md-nav__link">
    Fetch fastq data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kmerkit-analysis" class="md-nav__link">
    Kmerkit analysis
  </a>
  
    <nav class="md-nav" aria-label="Kmerkit analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialize-a-new-project" class="md-nav__link">
    Initialize a new project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-trimming-optional" class="md-nav__link">
    Read trimming (optional)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count-kmers" class="md-nav__link">
    Count kmers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-kmers" class="md-nav__link">
    Filter kmers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-gwas" class="md-nav__link">
    Perform GWAS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reproducibility" class="md-nav__link">
    Reproducibility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#todo-post-pipeline-analysisvisualization-api" class="md-nav__link">
    TODO: Post-pipeline analysis/visualization API
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/eaton-lab/kmerkit/edit/master/docs/cookbooks/3-pedicularis-RAD-gwas.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>GWAS RAD-seq</h1>

<h2 id="workflow-diagram">Workflow diagram</h2>
<div class="mermaid">%%{init: {'theme': 'dark', "flowchart" : { "curve" : "basis" } } }%%
graph LR
    0(kinit)
    1(ktrim)
    A(kcount)
    B(kfilter)
    C(kmatrix)
    D(kgwas)
    0 --&gt; 1 --&gt; A --&gt; B --&gt; C --&gt; D

linkStyle default stroke-width:2px,fill:none,stroke:grey;       </div>
<h2 id="study-description">Study description</h2>
<p>Here we re-implement the study by Eaton et al. (in prep) to detect 
genomic loci associated with a novel floral trait in the plant species complex
<em>Pedicularis cranolopha</em>. This study uses single-end <strong>RAD-seq</strong> data 
to sequence 100 individuals from 18 populations which vary in presence/absence
of the trait of interest in a way that is discordant with the phylogeny.</p>
<p><cite>Citation in future</a></cite></p>
<h2 id="fetch-fastq-data">Fetch fastq data</h2>
<p>If you wish to follow along you can dowload the data from SRA with the
instructions below. </p>
<details class="abstract">
<summary>Download fastq data using sra-tools</summary>
<p>Download the latest version of the sratools from <a href="https://github.com/ncbi/sra-tools/wiki/01.-
Downloading-SRA-Toolkit">https://github.com/ncbi/sra-tools/wiki/01.-Downloading-SRA-Toolkit</a> by selecting the compiled binaries that are 
appropriate for your system (e.g., Linux or MacOSX). (I really do 
recommend that you use the latest version since this software is updated
frequently and does not maintain compatibility with older versions.)
Run the command below to download the fastq data for this study 
into a new directory.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># make a directory to store the raw fastq data files</span>
mkdir -p ./fastq-data

<span class="c1"># download files to the specified fastq directory</span>
<span class="k">for</span> run <span class="k">in</span> ERR4161581 ERR4161582 ERR4161583 ERR4161584<span class="p">;</span> <span class="k">do</span>
    fasterq-dump --progress --outdir ./fastq-data --temp . <span class="nv">$run</span><span class="p">;</span>
<span class="k">done</span>
</code></pre></div>
</details>
<h2 id="kmerkit-analysis">Kmerkit analysis</h2>
<h3 id="initialize-a-new-project">Initialize a new project</h3>
<p>We start by initing a new project to assign samples names to files. The data
are single-end</p>
<div class="highlight"><pre><span></span><code>kmerkit init --name forked --workdir /tmp --delim <span class="s2">&quot;_&quot;</span> ./fastq-data/*.gz 
</code></pre></div>
<p>This step creates a project JSON file, which will contain the fully reproducible 
information about each step in a kmerkit analysis. This file is updated 
upon each kmerkit module that is run. This file can be read directly, 
or, you can access a more nicely formatted view of specific results by calling
<code>kmerkit stats</code> and specifying a specific module.</p>
<div class="highlight"><pre><span></span><code>kmerkit stats --json /tmp/forked.json init
</code></pre></div>
<details class="tip">
<summary>kmerkit stats output</summary>
<div class="highlight"><pre><span></span><code><span class="go">...</span>
</code></pre></div>
</details>
<h3 id="read-trimming-optional">Read trimming (optional)</h3>
<p>We applied read-trimming using the default options in <code>fastp</code>, but also used
the option <code>--subsample 2e6</code> to normalize the number of reads among samples
to a maximum of 2M. </p>
<div class="highlight"><pre><span></span><code>kmerkit trim --json /tmp/forked.json --workers <span class="m">4</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>kmerkit stats --json /tmp/forked.json trim
</code></pre></div>
<details class="tip">
<summary>kmerkit stats output</summary>
<div class="highlight"><pre><span></span><code><span class="go">...</span>
</code></pre></div>
</details>
<h3 id="count-kmers">Count kmers</h3>
<p>Because RAD-seq generates data that extends directionally away from a cut-site
the resulting reads will have specific orientations. Thus, we turn off 
canonical kmer counting here to count each kmer and its reverse-complement 
as separate patterns. </p>
<div class="highlight"><pre><span></span><code>kmerkit count --json /tmp/forked.json <span class="se">\</span>
    --no-canonical --kmer-size <span class="m">17</span> --min-depth <span class="m">5</span> --workers <span class="m">4</span> 
</code></pre></div>
<div class="highlight"><pre><span></span><code>kmerkit stats --json /tmp/forked.json count
</code></pre></div>
<details class="tip">
<summary>kmerkit stats output</summary>
<div class="highlight"><pre><span></span><code><span class="go">...</span>
</code></pre></div>
</details>
<h3 id="filter-kmers">Filter kmers</h3>
<p>Here I assign samples to either the target group (1) or the filter group (0)
and keep kmers that occur in the frequency range 0.5-1.0 in the target, and 
exclude any that occur at all (i.e., in the range 0.0-1.0) in the filter 
group. </p>
<div class="highlight"><pre><span></span><code>kmerkit filter <span class="se">\</span>
    --json /tmp/forked.json <span class="se">\</span>
    -1 <span class="s1">&#39;...&#39;</span> <span class="se">\</span>
    -0 <span class="s1">&#39;...&#39;</span> <span class="se">\</span>
    --min_map <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="se">\</span>
    --max_map <span class="m">0</span>.0 <span class="m">1</span>.0  
</code></pre></div>
<div class="highlight"><pre><span></span><code>kmerkit stats -j /tmp/dioecy.json filter
</code></pre></div>
<details class="tip">
<summary>kmerkit filter results</summary>
<div class="highlight"><pre><span></span><code><span class="go">...</span>
</code></pre></div>
</details>
<h3 id="perform-gwas">Perform GWAS</h3>
<p>Now that we've identified a set of target kmers we will extract reads from 
fastq data files that contain these kmers. This is expected to pull out reads
mapping to male-specific regions of the <i>A. palmeri</i> genome. Here you 
can enter new fastq files to extract data from, or enter the names of samples
already in the project database, which will use the (trimmed) fastq data files
referenced in the JSON file. Here I don't enter any sample names, which 
defaults to performing extractions on all 4 samples in the database (we expect
to not recover any reads for the two female pop samples).</p>
<div class="highlight"><pre><span></span><code>kmerkit gwas --json /tmp/forked.json --kinship --logistic
</code></pre></div>
<details class="tip">
<summary>kmerkit stats output</summary>
<div class="highlight"><pre><span></span><code><span class="go">...</span>
</code></pre></div>
</details>
<h2 id="reproducibility">Reproducibility</h2>
<p>In addition to your scripts that can be used to reproduce your analysis, the 
JSON project file contains a full record of the samples, parameters, and the
order of analysis steps that make up your analysis.</p>
<details class="success">
<summary>kmerkit project JSON file</summary>
<div class="highlight"><pre><span></span><code><span class="go">...</span>
</code></pre></div>
</details>
<h2 id="todo-post-pipeline-analysisvisualization-api">TODO: Post-pipeline analysis/visualization API</h2>
<p>The <code>kmerkit</code> Python API can be used to perform post-pipeline analyses 
in a jupyter notebook. Here we create a plot of </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">kmerkit</span>

<span class="n">project</span> <span class="o">=</span> <span class="n">kmerkit</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="s2">&quot;/tmp/forked.json&quot;</span><span class="p">)</span>
<span class="o">...</span>
</code></pre></div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../2-arabidopsis-gwas/" class="md-footer__link md-footer__link--prev" aria-label="Previous: GWAS WGS many traits (Arabidopsis)" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              GWAS WGS many traits (Arabidopsis)
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../../js/custom.js"></script>
      
        <script src="https://unpkg.com/mermaid@8.9.2/dist/mermaid.min.js"></script>
      
    
  </body>
</html>